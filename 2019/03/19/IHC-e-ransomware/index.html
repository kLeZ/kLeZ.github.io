<!doctype html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="author" content="Alessandro 'kLeZ' Accardo" />
    <title>Alessandro 'kLeZ' Accardo personal website - IHC e ransomware</title>
    <link rel="stylesheet" href="/assets/bootstrap/bootstrap-reboot.min.css" />
    <link rel="stylesheet" href="/assets/bootstrap/bootstrap-grid.min.css" />
    <link rel="stylesheet" href="/assets/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="/assets/fontawesome-free/css/all.min.css" />
    <link rel="stylesheet" href="/assets/katex/katex.min.css" />
    <link rel="stylesheet" href="/assets/main.css" />
    <link type="application/atom+xml" rel="alternate" href="https://klez.me/feed.xml" title="Alessandro 'kLeZ' Accardo personal website" />
  </head>
  <body class="">
    <header class="masthead" style="background-image: url(/assets/img/home-bg.jpg)">
      <div class="overlay"></div>
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <div class="site-heading">
              <h1>Alessandro 'kLeZ' Accardo personal website</h1>
              <span class="subheading">This is the personal website of an Italian developer once called 'kLeZ'.</span>
            </div>
          </div>
        </div>
      </div>
    </header>
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand" href="/">kLeZ</a>
        <a class="navbar-brand" href="https://travis-ci.org/kLeZ/kLeZ.github.io" target="_blank">
          <img src="https://travis-ci.org/kLeZ/kLeZ.github.io.svg?branch=dev" alt="build status badge" />
        </a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navigation">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item ">
              <a class="nav-link" href="/build.html">Build</a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="/blog">Posts</a>
            </li>
            <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About me <span class="caret"></span></a>
              <div class="dropdown-menu">
                <a class="dropdown-item " href="/about">About</a>
                <a class="dropdown-item " href="/contatti">Contatti</a>
              </div>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="https://github.com/kLeZ/kLeZ.github.io">Repository</a>
            </li>
            <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Progetti <span class="caret"></span></a>
              <div class="dropdown-menu">
                <a class="dropdown-item " href="https://klez.me/wash-ideas">Wash Ideas (Alpha)</a>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <main class="container pt-3 pb-3" aria-label="Content">
      <article itemscope itemtype="http://schema.org/BlogPosting">
        <header>
          <h2>IHC e ransomware</h2>
          <small class="text-muted">Posted on
            <time datetime="2019-03-19T21:23:01+01:00" itemprop="datePublished">19 Mar 2019</time><span> by • <span class="font-italic" itemprop="author" itemscope itemtype="http://schema.org/Person">kLeZ</span></span></small>
        </header>
        <section itemprop="articleBody">
          <p>Sono profondamente in ritardo, lo so.<br />
            Sono stato a questo campeggio qualcosa come 7 mesi e mezzo fa, e andava riportato, ma non sapevo dove quindi non l’ho fatto; non me ne vogliate.</p>
          <p>Iniziamo dall’inizio. IHC significa <em>Italian Hackers’ Camp</em>, e il genitivo sassone è una di quelle cose di cui in IHE (<em>Italian Hackers’ Embassy</em>) abbiamo discusso di più. Come da tradizione di ogni gruppo hacker che va a soffermarsi sul dettaglio. Questo è un po’ <em>hacking</em> alla fine.</p>
          <p>IHC è un evento biennale che si è tenuto per la prima volta nel 2018 a Padova, se ti interessa vai sul <a href="https://ihc.camp">sito di IHC</a>.</p>
          <p>La community intorno a IHC e IHE, e soprattutto l’associazione che ha ideato, organizza e promuove la community e il campo, sono di quegli agglomerati molto attivi e pieni di gente bellissima.</p>
          <p>In quel di Padova, tra il 2 e il 5 di agosto, ho partecipato a questo bellissimo evento, mi sono divertito e ho imparato veramente tante cose, ho conosciuto della bella gente e non ultimo ho tenuto un talk, che è poi il motivo del titolo di questo post.</p>
          <p>Il talk verteva sulla tematica dei malware, dei ransomware nello specifico, dando alcuni numeri e spiegando in parole semplici cosa sono e come si diffondono. Ripropongo qui il transcript, il materiale preparatorio, le fonti e la presentazione. In calce alla pagina troverai anche il video del talk, disponibile comunque su YouTube nel <a href="https://www.youtube.com/channel/UCV9Dbt9F5pg1qWA1By-1tJg">canale di IHC2018</a>.</p>
          <!--more-->
          <p class="m-0 invisible zero-size">
            <a class="invisible" id="read-more">read more</a>
          </p>
          <h2 id="ransomware-efficacia-alle-stelle-un-po-di-numeri-vettori-e-target-più-un-extra">Ransomware, efficacia alle stelle: un po’ di numeri, vettori e target più un extra</h2>
          <p>Il livello di rischio legato a questo tipo di malware, che ormai di nuovo non ha davvero più nulla, è attualmente tra i più altri finora registrati. L’infezione si attesta in crescita anche nel primo trimestre 2018.</p>
          <p>La cosa che più sconvolge di questa categoria di malware, è la quasi totale assenza di soluzioni <em>post</em> infezione; l’unica strada realistica attualmente percorribile è la prevenzione, non solo a mezzo di anti-malware, che poco possono contro questa estesa minaccia, ma anche (e soprattutto) con dei metodi più <em>rudimentali</em> come il backup dei dati su sistemi e/o supporti di storage esterni all’host infetto.</p>
          <p>Navigheremo tra le pieghe della negligenza, analizzeremo vettori e target, dai più consueti ai più insoliti, e ricreeremo il brainstorm creativo che permette agli hacker senza scrupoli di creare questi veri e propri gioielli dell’ingegneria sociale divenuti oramai anche piuttosto remunerativi.</p>
          <h3 id="efficacia-e-alcuni-dati">Efficacia e alcuni dati</h3>
          <p>Di fatto questo metodo è l’unico che garantisce la salvaguardia dei dati, a patto che l’utente sia molto <strong>molto</strong> attento alla gestione dei dati, cosa che spesso non accade (e non solo per i privati o le PMI [piccole medie imprese; ndr]).</p>
          <p>Solo nello scorso anno la frequenza di infezioni ai danni di privati è passata da <strong>0,05 i/s nel Q1 2017</strong> a <strong>0,1 i/s nel Q3 2017</strong>, di fatto ottenendo una <strong>crescita del 100%</strong>.
            Per lo stesso periodo di riferimento le aziende sono state colpite <strong>ogni 40 s nel Q3 2017</strong>, crescendo di fatto anche qui di <strong>oltre il 100%</strong>.</p>
          <p>Per completare il ciclo di statistiche appena evidenziato, fino allo scorso anno (e sicuramente in aumento quest’anno, staremo a vedere) <strong>il 60% dei payload (6 su 10) erano ransomware</strong>.</p>
          <p>Visto che si parla di hacking e non è una conferenza di McAfee o Kaspersky, vediamo qualcosa di più interessante dei numeri.</p>
          <p>Scavando un minimo di più la cosa che appare evidente (e interessante!) è la nascita di “aziende” specializzate in ransomware. Di fatto, esattamente come succede con servizi leciti, esistono dei servizi in abbonamento che permettono di configurare e lanciare una campagna di estorsioni digitali: dei veri e propri <strong>RaaS</strong>, in puro stile <em>cloud</em>.</p>
          <p>La cosa interessante da questo punto di vista è il design di architetture, infrastrutture e moduli che è in realtà tipico del lavoro <em>enterprise</em> e molto desueto nel mondo hacker, che di solito è più basato sulla sperimentazione e sull’artigianato digitale.
            Insomma, con questa nuova minaccia l’approccio è molto più <em>corporation</em> che nella quasi totalità delle altre minacce presenti in rete.</p>
          <h3 id="vettori-canonici-e-insoliti">Vettori: <em>canonici</em> e <em>insoliti</em></h3>
          <p>Esempi tipici di vettori sono le iper sottovalutate email che con delle tecniche di <em>social engineering</em> spesso “artistiche” e grossolane riescono comunque a infettare centinaia di migliaia di vittime (<strong>scimmie</strong> è un termine tecnico spesso usato come sinonimo in questi casi).</p>
          <p>Noi di solito archiviamo il caso con un <strong>PEBCAK</strong> e con una serie di meritati insulti al primate di turno.</p>
          <p>Diversamente capita per chi invece è ingenuamente invogliato a scaricare ed eseguire il malware. Alcuni vettori piuttosto insoliti colpiscono le ignare (e ingenue) vittime che invece di passare attraverso ore e ore di sudato <em>gaming</em> preferiscono una <strong>mod</strong> per <em>cheattare</em> e immancabilmente vengono puniti per il tentativo.</p>
          <p>Un esempio reale di questo vettore piuttosto insolito è una “mod” per Minecraft che era addirittura a pagamento e funzionante e che una settimana dopo l’installazione attivava il malware (probabilmente per cifrare ogni cosa lentamente evitando di essere rilevato).</p>
          <h3 id="target-canonici-e-insoliti">Target: <em>canonici</em> e <em>insoliti</em></h3>
          <p>Considerata la necessità computazionale dei ransomware, i target soliti sono i PC piuttosto che dispositivi mobili o embedded (<em>IoT</em> , per i più hipster), per quanto comunque non manca chi tenta di entrare nella nicchia di business del device ransom, attualmente non molto praticata ma probabilmente piuttosto redditizia.</p>
          <p>Tra i target soliti sicuramente i più colpiti sono i PC aziendali, per l’ovvia probabilità di archiviare dati più importanti di una cartella piena di mkv o di mp3 o di semplici (e probabilmente poco importanti) fogli di calcolo contenenti il bilancio domestico.</p>
          <p>Tra i target insoliti, per contro, ci sono tutti i sistemi di <em>cloud storage</em> che, per ora, sono considerati sicuri (e vengono sistematicamente usati per i backup).</p>
          <p>Per quanto Google sia sicuramente più capace e sistematica nel fare i backup alle vostre foto, per evitare la perdita di dati, che sono più importanti per loro che per noi, tendo a non fidarmi troppo dei computer altrui preferendo ricorrere al vecchio hard disk esterno che torna offline appena terminato il backup.</p>
          <p>Non posso non guardare in avanti verso altri tipi di <strong>ransom attack</strong> più pericolosi che prevedono l’attacco ai <em>big data</em> sempre più personali legati all’IoT. Non ci sono ancora dati in merito, ma penso che ne sentiremo parlare.</p>
          <p>C’è una pletora di dati, legati alle cosiddette <em>smart home</em> e che vengono grossolanamente tenuti in casa senza particolari protezioni o meccanismi di backup automatico. Immaginate se il vostro pannello <strong>command &amp; control</strong> che controlla frigorifero, tapparelle, allarmi, serratura di casa (!!) e magari anche la porta del garage perdesse ogni informazione (o che queste siano cifrate): probabilmente vi ritrovereste a non poter entrare in casa vostra e l’unico modo per tornare a farlo sarebbe pagare un riscatto per far tornare al loro posto tutti i dati.<br />
            Questo è ovviamente piuttosto fantascientifico (e strizza l’occhio verso Mr. Robot) ma è perfettamente realizzabile con la attuale tecnologia.</p>
          <p>Immaginate cosa succederebbe se questo tipo di attacco fosse portato verso gli <strong>Amazon Go</strong> o verso i loro kit per <em>smart home</em>, <strong>Echo</strong> e <strong>Key</strong>.</p>
          <h2 id="esempio-pratico-super-mario-ransom-for-peach">Esempio pratico: <em>Super Mario: Ransom for Peach</em></h2>
          <p>Riprendendo l’idea della mod di Minecraft e qualche altro spunto da alcuni film ormai di culto (Jumanji e Saw) porto un esempio pratico.</p>
          <p>Un videogioco, l’ennesimo capitolo di <strong>Super Mario</strong>, in cui però quello che succede è che <strong>Bowser</strong> (lo storico <em>villain</em>) cifra tutti i tuoi dati in cloud (<strong>GDrive</strong>) e l’unico modo per decifrarli è trovare <strong>Peach</strong> e finire il gioco.</p>
          <p>Questo sarebbe un modo piuttosto <em>divertente e sadico</em> di sviluppare un ransomware, e l’attacco di ingegneria sociale alla base riuscirebbe con una probabilità piuttosto elevata, considerando il fatto che oggi la funzione di salvataggio in cloud è pressoché ubiqua e che quindi qualsiasi ignaro giocatore darebbe il proprio consenso.</p>
          <p>Con la possibilità di leggere e scrivere liberamente (perfino autorizzati legalmente dal proprietario!), e con degli SDK molto ben fatti, sarebbe relativamente semplice e comodo produrre un software di questo tipo usando un qualsiasi linguaggio di alto livello (C# o Java) e delle piattaforme di sviluppo molto consolidate (LibGDX o Unity3D).</p>
          <h2 id="final-thoughts-dati-a-rischio-la-causa-è-lanello-debole-ovviamente">Final thoughts: <em>dati a rischio, la causa è l’anello debole (ovviamente)</em></h2>
          <p class="text-center"><img src="/media/2019-03-19/ihc-e-ransomware/AIDS-Trojan.jpg" alt="AIDS-Trojan" class="img-fluid" /></p>
          <p>Non siamo nuovi a questa minaccia, la cui prima apparizione risale addirittura al 1989, anno in cui il Dott. Popp, <em>evolutionary biologist</em> della Harvard University, inviò <strong>20.000 floppy</strong> disk ad alcuni partecipanti alla conferenza internazionale sull’AIDS. Il malware è stato ovviamente soprannominato <em>The AIDS Trojan</em> e <em>PC Cyborg</em>, per la tecnica di ingegneria sociale usata per lo <em>spreading</em>.</p>
          <p>Dopo <strong>90 riavvii</strong>, il malware nascondeva tutte le directory e cifrava tutti i nomi dei file, chiedendo un riscatto di <strong>$ 189.00</strong> da inviare a mezzo posta alla <em>PC Cyborg Corp.</em> con base a Panama.</p>
          <h2 id="risorse-su-cui-ho-studiato-e-da-cui-ho-preso-dati-e-immagini">Risorse su cui ho studiato e da cui ho preso dati e immagini</h2>
          <p>Queste sono le risorse che ho usato per preparare il talk, e da cui ho preso i dati che cito.<br />
            Malwarebytes ha pubblicato un report (come ogni anno) in cui spiega nel dettaglio quali sono i vettori comuni e dettaglia addirittura fino ad arrivare alle CVE.<br />
            Il pdf è disponibile previa registrazione, motivo per cui pur avendolo non posso condividerlo.</p>
          <ul>
            <li><a href="https://sensorstechforum.com/q1-2018-malware-report-ransomware-dethroned-cryptominers/">Sensors Tech - Q1 2018 Malware Report: Ransomware Dethroned by Cryptominers</a></li>
            <li><a href="https://securelist.com/it-threat-evolution-q1-2018-statistics/85541/">SecureList - IT threat evolution Q1 2018. Statistics</a></li>
            <li><a href="https://www.datto.com/blog/common-types-of-ransomware">Datto - Common Types of Ransomware</a></li>
            <li><a href="https://www.symantec.com/security-center/threat-report">Symantec - ISTR 2018</a></li>
            <li><a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases/2018/fortinet-threat-landscape-report-reveals-an-evolution-of-malware.html">Fortinet Threat Landscape Report Reveals an Evolution of Malware to Exploit Cryptocurrencies</a></li>
            <li><a href="https://blog.trendmicro.com/3-reasons-the-ransomware-threat-will-continue-in-2018/">TrendMicro - 3 reasons the ransomware threat will continue in 2018</a></li>
            <li><a href="https://press.malwarebytes.com/2018/01/25/malwarebytes-annual-state-malware-report-reveals-ransomware-detections-increased-90-percent/">MalwareBytes - Malwarebytes Annual State of Malware Report Reveals Ransomware Detections Increased More Than 90 Percent</a></li>
            <li><a href="https://blog.360totalsecurity.com/en/2017-ransomware-trend-report-2018-forecast/">2017 Ransomware Trend Report and Forecast for 2018</a></li>
          </ul>
          <h2 id="il-talk-per-intero-grazie-ivoermejo-e-le-slide-a-corredo">Il talk per intero (grazie @IvoErMejo) e le slide a corredo</h2>
          <p><a href="/media/2019-03-19/ihc-e-ransomware/ransomware.odp">Ransomware: minaccia alle stelle</a></p>
          <div class="embed-responsive embed-responsive-16by9">
            <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/svUxYlMNtLw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
          </div>
        </section>
        <a href="/2019/03/19/IHC-e-ransomware/" hidden></a>
      </article>
      <p class="m-0 invisible zero-size">
        <a href="" class="invisible" id="comments">comments</a>
      </p>
      <h3>Comments</h3>
      <form method="post" action="https://klez-commenter.herokuapp.com/v2/entry/kLeZ/kLeZ.github.io/dev/comments/">
        <input name="options[redirect]" type="hidden" value="https://klez.me/2019/03/19/IHC-e-ransomware/#comments">
        <input name="options[slug]" type="hidden" value="IHC-e-ransomware">
        <div class="form-row">
          <div class="col form-group">
            <input type="text" id="username" name="fields[name]" class="form-control" placeholder="username" required="true" />
          </div>
          <div class="col form-group">
            <input type="email" id="email" name="fields[email]" class="form-control" placeholder="email adress (will not be published)" required="true" />
          </div>
          <div class="col form-group">
            <input type="text" id="url" name="fields[url]" class="form-control" placeholder="website url" />
          </div>
        </div>
        <div class="form-row">
          <div class="col form-group">
            <textarea id="message" name="fields[message]" rows="3" class="form-control" placeholder="comment to this post" required="true"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="col-sm-12 col-md-3 col-lg-2 form-group">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
          <div class="col form-group">
            <div class="alert alert-warning d-block small">New comments will be shown after moderation approval</div>
          </div>
        </div>
      </form>
      <div class="row justify-content-end text-right">
        <div class="col-6">
          <a id="scroller" class="btn m-3 p-2 text-light bg-dark rounded" title="Scroll to the top of the page">
            <i class="fa fa-5x fa-chevron-up"></i>
          </a>
        </div>
      </div>
    </main>
    <footer class="site-footer bg-light w-100 py-3">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <ul class="list-inline text-center">
              <li class="list-inline-item">
                <a href="https://github.com/kLeZ">
                  <i class="svg-icon fab fa-github"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://twitter.com/kLeZhAcK">
                  <i class="svg-icon fab fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://www.linkedin.com/in/alessandroaccardo">
                  <i class="svg-icon fab fa-linkedin"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://telegram.me/julius8774">
                  <i class="svg-icon fab fa-telegram"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="/feed.xml">
                  <i class="svg-icon fa fa-rss"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="mailto:klez@pm.me">
                  <i class="svg-icon fa fa-envelope"></i>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="row">
          <div class="col text-left">
            <small class="text-muted">Last build on <time datetime="2019-03-25T20:57:15+01:00">Mon, 25 Mar 2019 20:57:15 +0100</time></small>
          </div>
          <div class="col text-right">
            <small class="text-muted">Copyright © Alessandro 'kLeZ' Accardo 2019</small>
          </div>
        </div>
        <div class="row">
          <div class="col text-center">
            <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />
            <small class="text-muted">
              This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="text-secondary">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.
            </small>
          </div>
        </div>
      </div>
    </footer>
    <script src="/assets/jquery/jquery-3.3.1.min.js"></script>
    <script src="/assets/popper/popper.min.js"></script>
    <script src="/assets/popper/tooltip.min.js"></script>
    <script src="/assets/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/assets/fontawesome-free/js/all.min.js"></script>
    <script src="/assets/main.js"></script>
  </body>
</html>