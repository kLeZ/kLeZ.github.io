// Dark Mode Theme
// Applied via [data-theme="dark"] on <html>
// Supports three modes: light (default), dark, and system (auto via prefers-color-scheme)

// Theme toggle button
.theme-toggle {
	background: none;
	border: none;
	cursor: pointer;
	padding: 10px 12px;
	font-size: 16px;
	color: $dark;
	transition: color 0.2s;
	display: flex;
	align-items: center;
	gap: 4px;

	&:hover { color: $primary; }
	&:focus { outline: none; }

	.theme-icon { font-size: 18px; }

	.theme-label {
		font-size: 10px;
		font-weight: 800;
		text-transform: uppercase;
		letter-spacing: 1px;
		@include sans-serif-font;
	}
}

// Toggle colors on transparent navbar (desktop)
@media only screen and (min-width: 992px) {
	#mainNav:not(.is-fixed) .theme-toggle {
		color: $light;
		&:hover { color: fade-out($light, 0.2); }
	}

	#mainNav.is-fixed .theme-toggle {
		color: $dark;
		&:hover { color: $primary; }
	}
}

// =============================================
// Dark theme overrides
// =============================================

[data-theme="dark"] {
	body {
		background-color: $dark-bg;
		color: $dark-text;
	}

	a {
		color: $dark-primary;
		&:focus, &:hover { color: $dark-text-muted; }
	}

	h1, h2, h3, h4, h5, h6 {
		color: $dark-text-heading;
	}

	// Selection
	::-moz-selection { color: $light; background: $primary; }
	::selection { color: $light; background: $primary; }

	// Navbar
	#mainNav {
		background-color: $dark-bg;
		border-bottom-color: $dark-border;

		.navbar-brand { color: $dark-text; }
		.navbar-toggler { color: $dark-text; }

		.navbar-nav > li.nav-item {
			> a {
				color: $dark-text;
				&:focus, &:hover { color: $dark-primary; }
			}
			&.active > a { color: $dark-accent; }
		}
	}

	.theme-toggle {
		color: $dark-text;
		&:hover { color: $dark-primary; }
	}

	@media only screen and (min-width: 992px) {
		#mainNav:not(.is-fixed) {
			.navbar-brand {
				color: $light;
				&:focus, &:hover { color: fade-out($light, 0.2); }
			}
			.navbar-nav > li.nav-item > a { color: $light; }
		}

		.theme-toggle { color: $light; }
		#mainNav:not(.is-fixed) .theme-toggle {
			color: $light;
			&:hover { color: fade-out($light, 0.2); }
		}

		#mainNav.is-fixed {
			background-color: rgba($dark-bg, 0.95);
			border-bottom-color: $dark-border;

			.navbar-brand {
				color: $dark-text;
				&:focus, &:hover { color: $dark-primary; }
			}

			.navbar-nav > li.nav-item {
				> a {
					color: $dark-text;
					&:focus, &:hover { color: $dark-primary; }
				}
				&.active > a { color: $dark-accent; }
			}

			.theme-toggle {
				color: $dark-text;
				&:hover { color: $dark-primary; }
			}
		}
	}

	// Dropdown menus
	.dropdown-menu {
		background-color: $dark-bg-elevated;
		border-color: $dark-border;
	}

	.dropdown-item {
		color: $dark-text;
		&:hover, &:focus {
			background-color: $dark-border;
			color: $dark-primary;
		}
		&.active {
			background-color: $dark-border;
			color: $dark-accent;
		}
	}

	// Masthead
	header.masthead {
		background-color: $dark-bg-sunken;

		.overlay {
			background-color: #0d1117;
			opacity: 0.65;
		}
	}

	// Post previews
	.post-preview {
		> a {
			color: $dark-text;
			&:focus, &:hover { color: $dark-primary; }
		}

		> .post-meta {
			color: $dark-text-muted;
			> a {
				color: $dark-text;
				&:focus, &:hover { color: $dark-primary; }
			}
		}
	}

	// Cards
	.card {
		background-color: $dark-bg-elevated;
		border-color: $dark-border;
	}

	.card-footer {
		background-color: darken($dark-bg-elevated, 2%);
		border-top-color: $dark-border;
	}

	.card-subtitle.text-muted {
		color: $dark-text-muted !important;
	}

	// Blockquotes
	blockquote:not(.content) {
		background-color: $dark-bg-elevated;
		border-left-color: $dark-text;
		color: $dark-text;
	}

	// Buttons
	.btn-primary {
		background-color: $primary;
		border-color: $primary;
		&:hover, &:focus, &:active {
			background-color: darken($primary, 7.5) !important;
			border-color: darken($primary, 7.5) !important;
		}
	}

	.btn-dark {
		background-color: $dark-primary;
		border-color: $dark-primary;
		color: $dark-bg;
		&:hover, &:focus {
			background-color: darken($dark-primary, 7.5);
			border-color: darken($dark-primary, 7.5);
			color: $dark-bg;
		}
	}

	// Footer
	footer.site-footer {
		background-color: $dark-bg-sunken !important;
		color: $dark-text-muted;

		.copyright { color: $dark-text-muted; }
		.svg-icon { fill: $dark-text-muted; color: $dark-text-muted; }
	}

	// Scroll to top
	#scroller.bg-dark {
		background-color: $dark-primary !important;
	}

	// Forms
	.floating-label-form-group {
		border-bottom-color: lighten($dark-border, 5%);

		input, textarea {
			color: $dark-text;
			&::-webkit-input-placeholder { color: $dark-text-muted; }
		}
	}
	.floating-label-form-group-with-focus label { color: $dark-primary; }

	// Bootstrap utility overrides
	.bg-light { background-color: $dark-bg !important; }
	.text-muted { color: $dark-text-muted !important; }
	.text-dark { color: $dark-text !important; }
	.border-dark { border-color: $dark-border !important; }
	.border-bottom { border-bottom-color: $dark-border !important; }

	// Premonition boxes
	.premonition {
		background-color: #1e2a32;
		.content { color: rgba($dark-text, 0.7); }
		code { background-color: $dark-bg-elevated; }
		&.info { background-color: #1a2e1a; }
		&.warning { background-color: #2e2a1a; }
		&.error { background-color: #2e1a1a; }
		&.citation { background-color: $dark-bg-elevated; }
	}

	// Code and pre
	code { color: #e06c75; background-color: $dark-bg-elevated; }
	pre { background-color: $dark-bg-elevated; color: $dark-text; }

	// Tables
	table, .table { color: $dark-text; }
	.table-bordered {
		border-color: $dark-border;
		td, th { border-color: $dark-border; }
	}
	.table-striped tbody tr:nth-of-type(odd) {
		background-color: rgba($white, 0.03);
	}

	// Sticky sidebars (reading time, TOC)
	.sticky-top { background-color: $dark-bg-elevated !important; }
	.shadow { box-shadow: 0 .5rem 1rem rgba($black, .3) !important; }

	// Misc
	hr { border-top-color: $dark-border; }
	.section-heading { color: $dark-text-heading; }
	.caption { color: $dark-text-muted; }
	.bg { background-color: $dark-bg; }
}
